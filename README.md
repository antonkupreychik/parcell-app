# Возможности пользователей

### 1. Создание пользователя - `POST /api/v1/users`

Здесь мы заполняем координаты, откуда курьеру нужно будет забрать посылку

**Запрос:**

```
{
  "name": "Customer",
  "email": "email@emaisl.com",
  "password": "passwo!312JGsnrd",
  "coordinates": {
    "latitude": "60.4501",
    "longitude": "30.5234"
  }
}
```

**Ответ:**

```
{
  "id": 3,
  "name": "User 1",
  "email": "email@emai2l.com"
}
```

### 2. Пополнение баланс пользователя - `POST /api/v1/users/balance`

**Запрос:**

```
{
  "userId": 1,
  "balance": 100,
  "operationType": "ADD"
}
```

**Ответ:**

```
{
  "id": 1,
  "balance": 1017.54
}
```

### 3. Создаем посылку - `POST /api/v1/parcels`

Координаты в этом запросе, обозначают куда нужно доставить посылку
В этом же запросе мы получаем предварительную стоимость доставки.
Она измеряется исходя из веса и габаритов посылки, а также расстояния между точками отправления и получения.

**Запрос:**

```
{
  "name": "Parcel 1",
  "weight": 10,
  "width": 10,
  "height": 10,
  "length": 10,
  "description": "Parcel 1",
  "address": {
    "country": "Ukraine",
    "city": "Kyiv",
    "street": "Khreshchatyk",
    "houseNumber": "1",
    "apartmentNumber": "1",
    "zipCode": "01001",
    "coordinates": {
      "latitude": "78.4501",
      "longitude": "30.5234"
    }
  }
}
```

**Ответ:**

```
  "name": "Parcel 1",
  "weight": 10,
  "width": 10,
  "height": 10,
  "length": 10,
  "description": "Parcel 1",
  "status": "NEW",
  "price": 156.86,
  "address": {
    "id": 12,
    "country": "Ukraine",
    "city": "Kyiv",
    "street": "Khreshchatyk",
    "houseNumber": "1",
    "apartmentNumber": "1",
    "zipCode": "01001",
    "coordinates": "13.4501, 30.5234"
  }
}
```

### 4. Просмотр информации о посылках пользователя - `GET /api/v1/parcels?`

Информация возвращается постранично, по умолчанию 10 записей на странице.
> Есть возможность сортировки по любому полю, по возрастанию или убыванию.
> Так же есть возможность поиска по имени посылки.
> Так же есть сортировка по статусам посылки, в запросе нужно передать параметр `statuses` с любым возможным статусом.

**Запрос:**

` GET /api/v1/parcels?page=0&size=10&sort=name&direction=ASC&search=parcel&statuses=NEW,DELIVERED `

**Ответ:**

```
{
  "content": [
    {
      "id": 4,
      "name": "Parcel 1",
      "weight": 10,
      "width": 10,
      "height": 10,
      "length": 10,
      "description": "Parcel 1",
      "status": "CANCELED"
    },
    ...
    ],
  "totalPages": 1,
  "totalElements": 8,
  "pageSize": 10,
  "pageNumber": 0,
  "sort": {
    "field": "name",
    "direction": "ASC"
  }
}
```

### 5. Просмотр информации о посылке - `GET /api/v1/parcels/{id}`

Запрос возвращает более подробную информацию о посылке, включая адрес доставки и стоимость доставки.

**Ответ:**

```
{
  "name": "Parcel 1",
  "weight": 10,
  "width": 10,
  "height": 10,
  "length": 10,
  "description": "Parcel 1",
  "status": "NEW",
  "price": 156.86,
  "address": {
    "id": 12,
    "country": "Ukraine",
    "city": "Kyiv",
    "street": "Khreshchatyk",
    "houseNumber": "1",
    "apartmentNumber": "1",
    "zipCode": "01001",
    "coordinates": "13.4501, 30.5234"
  }
}

```

### 6. Просмотр информации о балансе пользователя - `GET /api/v1/users/balance`

Запрос возвращает баланс пользователя, а также историю операций по балансу(сделать это!)

**Ответ:**

```
  {
  "id": 1,
  "balance": 860.68
  }
```

### 6. Отмены посылки - `POST /api/v1/parcels/{id}/cancel`

При отмене посылки, пользователь получает возврат денег на свой баланс.
Если на посылку еще не назначен курьер, возвращается полная сумма.
Если курьер уже назначен, но посылка не передана, возвращается 80% суммы.
Если курьер уже назначен и посылка передана, возвращается 30% суммы.
Настройки для процентов можно найти в таблице `config` в БД.

**Запрос:**

```
{
  "parcelId": 1
}
```

**Ответ:**

```
code: 204
```

# Возможности администратора

### 1. Создание курьера - `POST /api/v1/users/courier`

```
{
  "name": "Customer",
  "email": "email@emaisl.com",
  "password": "passwo!312JGsnrd",
  "coordinates": {
    "latitude": "60.4501",
    "longitude": "30.5234"
  }
}
```

Координаты - это текущее местоположение курьера

### 2. Назначение курьера на посылку - `POST /api/v1/parcels/{parcelId}/assign/{courierId}`

```
{
  "parcelId": 1,
  "courierId": 1
}
```

По итогу, для пользователя будет рассчитана окончательная стоимость, с учетом расстояния до пользователя и до посылки, а
также с учетом комиссии сервиса.

# Возможности курьера

### 1. Просмотр информации о посылках - `GET /api/v1/parcels`

```
?page=0&size=10&sort=name&direction=ASC&search=parcel \
```

Информация возвращается постранично, по умолчанию 10 записей на странице.
Есть возможность сортировки по любому полю, по возрастанию или убыванию.
Так же есть возможность поиска по имени посылки.
Так же есть сортировка по статусам посылки, в запросе нужно передать параметр `statuses` с любым возможным статусом.

### 2. Просмотр информации о посылке - `GET /api/v1/parcels/{id}`

Запрос возвращает более подробную информацию о посылке, включая адрес доставки и стоимость доставки.

### 3. Изменить статус посылки - `POST /api/v1/parcels/{parcelId}/status/{status}`

Запрос позволяет изменить статус посылки.